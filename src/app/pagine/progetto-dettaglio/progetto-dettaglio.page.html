<ion-header>
  <ion-toolbar class="ff7-toolbar">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/progetti"></ion-back-button>
    </ion-buttons>
    <ion-title>{{ project?.name || 'Dettagli Progetto' }}</ion-title>
    <ion-buttons slot="end" *ngIf="project">
      <ion-button (click)="editProject()">
        <ion-icon slot="icon-only" name="create-outline"></ion-icon>
      </ion-button>
      <ion-button (click)="deleteProject()">
        <ion-icon slot="icon-only" name="trash-outline" color="danger"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ff7-content">
  <div *ngIf="isLoading" class="loading-overlay">
    <ion-spinner name="crescent"></ion-spinner>
    <p>Caricamento progetto...</p>
  </div>

  <div *ngIf="!isLoading && project" class="project-detail-container">
    <ion-card class="ff7-card">
      <ion-card-header>
        <div class="header-details">
          <ion-card-title>{{ project.name }}</ion-card-title>
          <ion-text [color]="getStatusColor(project.status)">
            <ion-card-subtitle>{{ project.status }}</ion-card-subtitle>
          </ion-text>
        </div>
      </ion-card-header>

      <ion-card-content>
        <p class="project-description">{{ project.description }}</p>

        <div class="detail-item" *ngIf="project.dueDate">
          <span>Scadenza:</span>
          <strong>{{ project.dueDate | date:'dd/MM/yyyy' }}</strong>
        </div>

        <div class="members-container" *ngIf="projectMembers && projectMembers.length > 0">
          <h4 class="members-title">Membri del Progetto</h4>
          <div class="members-list">
            <div *ngFor="let member of projectMembers" class="member-item">
              <img [src]="member.photo || 'assets/immaginiGenerali/default-avatar.jpg'" class="profile-image">
              <div class="member-info">
                <span>{{ member.name || member.nickname }}</span>
                <small>{{ '@' + member.nickname }}</small>
              </div>
            </div>
          </div>
        </div>
        </ion-card-content>
    </ion-card>
  </div>

  <div *ngIf="!isLoading && !project" class="no-project-message">
    <p>Progetto non trovato.</p>
  </div>

  <ion-modal [isOpen]="showEditModal" (didDismiss)="onModalDismiss($event)">
    <ng-template>
      <app-progetto-form [projectToEdit]="projectToEdit" (modalDismissed)="onModalDismiss($event)"></app-progetto-form>
    </ng-template>
  </ion-modal>
</ion-content>
