<div class="modal-backdrop" (click)="onBackdropClick($event)">
  <div class="modal-content">
    <div class="modal-header">
      <h2>{{ title }}</h2>
      <button (click)="dismiss()" class="close-button">Ã—</button>
    </div>

    <form [formGroup]="projectForm" class="project-form">
      <div class="form-group">
        <label for="name">Nome Progetto</label>
        <input id="name" type="text" formControlName="name" placeholder="Inserisci il nome"
          [ngClass]="{'is-invalid': projectForm.get('name')?.invalid && projectForm.get('name')?.touched}">
      </div>

      <div class="form-group">
        <label for="description">Descrizione</label>
        <textarea id="description" formControlName="description" placeholder="Descrivi il tuo progetto"
          [ngClass]="{'is-invalid': projectForm.get('description')?.invalid && projectForm.get('description')?.touched}"></textarea>
      </div>

      <div class="form-group">
        <label for="status">Stato</label>
        <select id="status" formControlName="status">
          <option value="In corso">In corso</option>
          <option value="Completato">Completato</option>
          <option value="In pausa">In pausa</option>
          <option value="Archiviato">Archiviato</option>
        </select>
      </div>

      <div class="form-group">
        <label for="dueDate">Scadenza</label>
        <input id="dueDate" type="date" formControlName="dueDate">
      </div>

      <div class="form-group">
        <label for="members">Membri del Progetto</label>
        <div class="user-search-container">
          <input type="text" id="members" [(ngModel)]="searchTerm" (ngModelChange)="searchUsers()"
            [ngModelOptions]="{ standalone: true }" placeholder="Cerca per nome o nickname">
        </div>

        <div *ngIf="searchResults.length > 0" class="search-results-list">
          <div *ngFor="let user of searchResults" class="user-result-item" (click)="selectUser(user)">
            <img [src]="user.photo || 'assets/immaginiGenerali/default-avatar.jpg'" class="profile-image">
            <div class="user-info">
              <span>{{ user.name || user.nickname }}</span>
              <small>{{ user.nickname }}</small>
            </div>
          </div>
        </div>

        <div class="selected-users-list">
          <div *ngFor="let user of selectedUsers" class="selected-user-item">
            <img [src]="user.photo || 'assets/immaginiGenerali/default-avatar.jpg'" class="profile-image">
            <div class="user-info">
              <span>{{ user.name || user.nickname }}</span>
              <small>{{ user.nickname }}</small>
            </div>
            <ion-icon name="close-circle" (click)="removeUser(user)"></ion-icon>
          </div>
        </div>
      </div>
      <button type="submit" (click)="saveProject()" class="submit-button">Salva</button>
    </form>
  </div>
</div>
